CREATE OR REPLACE QUERY output_party_cc_to_file(STRING output_file_path = "/home/tigergraph/gsql_output/party_cc_output.txt") { 
  
  FILE f (output_file_path);
  
  f.println("Party", "Connected_Component");
  
  entities = {Party.*};
  
  components = SELECT t
      FROM entities:s-(Entity_In_Ring:e)-Connected_Component:t
      ACCUM f.println(s.id, t.id)
  ;
  
  PRINT "Results file created!" AS result;
  
}